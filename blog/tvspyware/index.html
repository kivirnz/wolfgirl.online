<!DOCTYPE html>
<!-- Auto-generated from blog-md/tvspyware.md by build.sh -->
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Decrappifying A Cheap Android TV Box - Wolfgirl –û–Ω–ª–∞–π–Ω! ŒòŒî</title>
  <link rel="canonical" href="https://wolfgirl.online/blog/tvspyware.html">
  <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png">
  <link rel="icon" type="image/x-icon" href="../../favicon.ico">
  <link rel="apple-touch-icon" href="../../apple-touch-icon.png">
  <link rel="stylesheet" href="../../style.css">
  <link rel="stylesheet" href="../../vendor/atom-one-light.min.css" media="(prefers-color-scheme: light)">
  <link rel="stylesheet" href="../../vendor/atom-one-dark.min.css" media="(prefers-color-scheme: dark)">
  <script src="../../vendor/highlight.min.js"></script>
  <script>document.addEventListener('DOMContentLoaded', () => hljs.highlightAll());</script>
</head>

<body>
  <article>
    <header>
      <div class="article-header-row">
        <a href="/" class="back">‚Üê Back</a>
        <a href="/" class="home-icon" aria-label="Home">
          <picture>
            <source srcset="../../images/wolf-white.svg" media="(prefers-color-scheme: dark)">
            <img src="../../images/wolf-white.svg" alt="">
          </picture>
        </a>
      </div>
      <h1>Decrappifying A Cheap Android TV Box</h1>
      <div class="meta-row">
        <time datetime="2025-10-06">6 October 2025 ¬∑ 30 min read</time>
      </div>
    </header>

    <p>So, I‚Äôve just moved into an incredible little place in the
      central Auckland area. It‚Äôs an apartment, but the most amazing part
      is that I have it all to myself! The hallway, bedroom, bathroom,
      boiler room, living room and kitchen is all mine! I‚Äôm super chuffed
      with it, but by far, the most exciting part to me is that I have a
      living room all to myself, where I can lay back and watch a movie at
      the end of a long day on my TV! One issue with that though, my TV
      isn‚Äôt exactly uhh‚Ä¶ smart.</p>
    <p>Not that it‚Äôs a bad TV by any means, it‚Äôs a <a href="https://pricespy.co.nz/product.php?p=5357342">32‚Äù Veon
        TV</a>
      that I bought several years ago and it works great, but due to it
      being a Warehouse OEM TV, it‚Äôs not capable of any sort of ‚Äòsmart‚Äô
      functionality sadly. <a
        href="https://www.thewarehouse.co.nz/p/veon-32-inch-hd-android-smart-tv-vn32id70/R2838317.html">Later
        revisions are</a>, but mine sadly isn‚Äôt. All I had plugged into it
      was a <a href="https://consolemods.org/wiki/PS3:FAQ#What_is_the_point_of_jailbreaking?">CFW‚Äôd
        PS3 Slim</a> running a piece of homebrew called <a href="https://movian.eu/">Movian</a> (as well as my totally
      legally
      obtained game backups, <em>cough cough</em>). Movian is a piece of
      homebrew for the PS3 that allows for viewing media via the internal
      hard drive, DLNA shares, IPTV resources and it has plugins capable
      of ripping content straight from reputable torrent trackers such as
      <a href="https://yts.mx/">YTS</a>, TGx (RIP üôè) and <a href="https://eztvx.to/">ezTV</a>. However! While all of
      these
      upsides are amazing, there are sadly two downsides which I will
      explain:
    </p>
    <ol type="1">
      <li>
        <p><strong>No Jellyfin or Navidrome support.</strong> For those
          of you unaware, I run Jellyfin and Navidrome instances accessible <a
            href="https://jellyfin.kivir.pet/">here</a> and <a href="https://navidrome.kivir.pet/">here</a>. They‚Äôre
          running on an
          old laptop (HP ProBook 650 G1) with Ubuntu Server installed and it
          works absolutely amazingly. However, Movian does not have the
          ability to connect to Navidrome or Jellyfin instances natively. I‚Äôm
          sure that it is possible with a fork of the repo and a bit of
          creativity when it comes to making your own plugin, but I decided
          not to go down that route. So I enabled DLNA via a piece of software
          called <a href="https://github.com/azatoth/minidlna">MiniDLNA</a>
          and I was able to fully access it via Movian. In fact, it even
          detected the share on my network automatically! Brilliant! However,
          when I went to play a 1080p MKV file, something bad happened which I
          will explain next.</p>
      </li>
      <li>
        <p><strong>The PS3 cannot handle 1080p encoding
            (mostly).</strong> The PS3‚Äôs PPC-based Cell CPU is pretty good, but
          it is showing its age in 2025. Of course 1080p encoding works on
          this through the Blu-Ray players methods (H.264 + FLAC), but for
          anything outside of that, you‚Äôre unlikely to get anything more than
          3 frames per second. Which really sucks as most of my media uses
          HEVC (H.265) video and Dolby Digital Plus (E-AC3) audio. That‚Äôs just
          unusable for me.</p>
      </li>
    </ol>
    <p>So, while I am of course going to still use my PS3 for the thing
      that it was designed to do (play games obviously), I can‚Äôt get it to
      watch any of my local media which absolutely sucks. So, what‚Äôs the
      next best thing‚Ä¶ a Chromecast!</p>
    <p>Unfortunately, all Chromecast models lack Android TV (to
      interface with my local services), but what doesn‚Äôt lack Android TV
      is Google‚Äôs new ‚Äò<a href="https://www.pbtech.co.nz/product/TVNGOG5662/Google-TV-Streamer-4K---White">Google
        TV Streamer</a>‚Äô! Sadly, the price is a whopping <strong>$179
        NZD!</strong> That‚Äôs $104 USD for my American friends and ¬£77 GBP
      for my British friends!</p>
    <p><img src="../../images/blog/tvspyware/streamer.png" alt="captionless image" /></p>
    <p>Completely out of my price range. So I settled for the next best
      thing, an Android TV box from everyones favorite website, AliExpress
      (boooooooo).</p>
    <p>The first thing that came up when I searched for ‚ÄòAndroid TV box‚Äô
      was <a href="https://www.aliexpress.com/item/1005007446408954.html">this
        lil curiosity</a>.</p>
    <p><img src="../../images/blog/tvspyware/aliexpress.png" alt="captionless image" /></p>
    <p>It‚Äôs called a ‚Äò<strong>Q10</strong>‚Äô, all models come shipped
      with an <strong>Allwinner H313</strong> SOC and has models that go
      from 2gb RAM/16gb ROM all the way up to 8gb RAM/128gb ROM. So with
      me being a cheapass, this being the cheapest one on AliExpress and
      not really needing 128gb of storage (as all of my media is living on
      my homelab anyways), I decided to buy the 2gb RAM/16gb ROM model
      with an extra keyboard controller. 2 weeks later and it finally
      arrived!</p>
    <p><img src="../../images/blog/tvspyware/unboxing.png" alt="captionless image" /></p>
    <p>Now, I‚Äôve seen these Chinese Android TV boxes in the past and I
      know how they work. Usually, many of them come preconfigured with 3
      things:</p>
    <ol type="1">
      <li>An absolutely dogshit looking launcher</li>
      <li>Lies about their system specifications</li>
      <li>A myriad of Chinese malware</li>
    </ol>
    <p>So it was basically my goal to remove both of these things (and
      in the case of the first, remove the stock launcher) because on
      <strong>MOST</strong> (<em>not all</em>) Chinese Android TV boxes,
      they look something like this and it makes me want to puke:
    </p>
    <p><img src="../../images/blog/tvspyware/launcher.png" alt="captionless image" /></p>
    <p>But anyways, once I unboxed the device (and popped down to the
      dairy to buy some AAA batteries for the remotes), I set it all up
      and surprise surprise, there wasn‚Äôt a gross looking launcher at all!
      It was as stock as stock can be (launcher-wise, wait for the next
      part).</p>
    <p><img src="../../images/blog/tvspyware/real_launcher.png" alt="captionless image" /></p>
    <p>So, with item 1 crossed off the list, I decided to move on with
      the other two. The next one on the list was ‚Äòlying about system
      specifications‚Äô. The reason why I had this suspicion in mind was due
      to the reviews on the AliExpress listing. It‚Äôs a mixture of either
      bots or technologically incapable Latin American buyers giving the
      device 5 stars and praising this device for how marvelous it is, or
      some more technologically capable people who checked the specs of
      the device and were shocked.</p>
    <p><img src="../../images/blog/tvspyware/true_specs.png" alt="captionless image" /></p>
    <p>As we can see from this screenshot (helpfully provided by an
      anonymous Peruvian buyer), the machine has a maximum output of 720p
      (far from the 8k advertised on the box hahaha), it‚Äôs running Android
      10 with the strings changed to say 14, and it only has a whopping
      256mb of RAM!?!?!?!?!?</p>
    <p>I really really wanted to check if this was real, or hey, maybe
      they just accidentally sent the guy a test unit by accident. So I
      downloaded an APK version of an app called ‚Äò<a
        href="https://play.google.com/store/apps/details?id=ru.andr7e.deviceinfohw&amp;hl=en_NZ">Device
        Info HW</a>‚Äô to see if my theory was correct. But sadly, I ran into
      an issue when attempting to install it.</p>
    <p><img src="../../images/blog/tvspyware/dihw_failed.png" alt="captionless image" /></p>
    <p><em>Hmmmmm~</em>, well that‚Äôs odd! I tried downloading an even
      older version of the app from 2020, but I still got the same error!
      So I tried two similar apps named ‚Äò<a
        href="https://play.google.com/store/apps/details?id=flar2.devcheck&amp;hl=en_NZ">DevCheck</a>‚Äô
      and ‚Äò<a href="https://f-droid.org/en/packages/com.kgurgul.cpuinfo/">CPU
        Info</a>‚Äô, but guess what happened‚Ä¶</p>
    <p><img src="../../images/blog/tvspyware/devcheck_failed.png" alt="captionless image" /> <img
        src="../../images/blog/tvspyware/cpuinfo_failed.png" alt="captionless image" /></p>
    <p>This leads me to only one conclusion, <strong>the manufacturer
        doesn‚Äôt wish to reveal the true specs of the device</strong>. They
      somehow have a blacklist of package names which reveal system
      specifications, <strong>OR</strong> these apps require a special
      permission to see system specs and the installer blocks all of them
      by default. Very very strange. The weirdest bit is that this device
      doesn‚Äôt block APK installation entirely, I was able to get <a
        href="https://play.google.com/store/apps/details?id=com.ghisler.android.TotalCommander&amp;hl=en_NZ">Total
        Commander</a> installed on it with no issues. This is just‚Ä¶
      extremely shady to me. I think the Peruvian guy who left the
      AliExpress screenshot earlier raised some alarm bells for the
      manufacturer, so they added in the blocklist on later revisions.</p>
    <p>The ONLY solution I found to this was (and many of you are gonna
      laugh at me rightfully)‚Ä¶ <a href="https://play.google.com/store/apps/details?id=com.termux&amp;hl=en">Termux</a>
      and <a href="https://github.com/dylanaraps/neofetch">Neofetch</a>.
      No, I‚Äôm not joking, take that in for a second. But it did
      surprisingly work to my astonishment. The only issue was that the
      on-screen keyboard showed up the whole time, which meant that I had
      to pipe neofetch to a text file and read it with Nano as I wasn‚Äôt
      able to read the whole thing. And when I did, I was shocked!</p>
    <p><img src="../../images/blog/tvspyware/neofetch.png" alt="captionless image" /></p>
    <p>It is indeed showing 2gb of RAM and Android 14! I would later
      come to learn that this is a flat out lie, but it really does go to
      show how far the manufacturers went out of their way to fabricate
      the true system specifications. The way how I came to learn that it
      was really running Android 10 was by going to the Settings of the
      device and looking at the preinstalled apps, there we can see
      something very curious.</p>
    <p><img src="../../images/blog/tvspyware/android10.jpg" alt="captionless image" /></p>
    <p>For those of you unaware, <a href="https://en.wikipedia.org/wiki/Android_10">Android Q</a> was
      actually the codename for Android 10. So now we know the truth!</p>
    <p>Whew, so with that out of the way, now we can confirm (at least
      one of) the actual system specs, so I decided to put that idea on
      hold for now and turn to the third goal of my project, removing all
      the malware. But firstly, I‚Äôd need to see what malware actually
      comes included in the machine. So, off to ADB we go!</p>
    <p>Quick explainer for some of you, ADB is the Android Debug Bridge.
      It‚Äôs basically a piece of software that comes included in the
      Android SDK which allows for any PC running Windows, Mac or Linux to
      interact with the internals of any Android device. All that‚Äôs needed
      for this to work is for an option in the Developer Settings in the
      Android device to be enabled to work for this. On most Android
      devices like phones and tablets, an option called ‚ÄòAllow USB
      debugging‚Äô is all that‚Äôs required for this to work. However, the
      keen-eyed among you may have realized an issue. In order for what‚Äôs
      called ‚Äòwired ADB‚Äô to work, that requires a USB-C or micro-USB port
      to be installed in the system which then gets connected to my PC,
      which this one sadly doesn‚Äôt. What is on our side though is a
      function called ‚Äòwireless ADB‚Äô. This works exactly in our favor,
      however it does require for an option called ‚ÄòEnable wireless
      debugging‚Äô to be enabled in the developed options as well. Yet when
      I tried to look for it in the settings, it just, wasn‚Äôt there. Upon
      further research, guess what, wireless ADB is only a feature that
      was introduced in <a href="https://developer.android.com/tools/adb#connect-to-a-device-over-wi-fi"><strong>Android
          11</strong></a>!</p>
    <p><img src="../../images/blog/tvspyware/android11.png" alt="captionless image" /></p>
    <p>However, I should explain more about what the Android SDK docs
      exactly mean by ‚Äòwireless ADB‚Äô though, as it isn‚Äôt as bad as I made
      it sound. Wireless ADB has 2 meanings in Android, either one where
      you pair it via a pairing code or QR code (which is what was
      introduced in Android 11), but you have always been able to just run
      the command:</p>
    <pre><code>adb connect $device_ip_here</code></pre>
    <p>So by doing that, ta-da!!!</p>
    <p><img src="../../images/blog/tvspyware/adb_connect.png" alt="captionless image" /></p>
    <p>Anyways, the very first thing I did was to check the system specs
      once again because my dumb ass <strong>cannot</strong> let shit
      go.</p>
    <p><img src="../../images/blog/tvspyware/adb_specs.png" alt="captionless image" /></p>
    <p>So, it was lying about being an ARMv8 chip as it‚Äôs very clearly
      ARMv7a, but it is still displaying Android 14 and 2gb of RAM, very
      strange. But anyways, let‚Äôs press on!</p>
    <p>I ran the command:</p>
    <pre><code>adb shell pm list packages</code></pre>
    <p>So I could see the full list of packages installed on my system,
      it looked like this:</p>
    <pre><code>com.softwinner.TvdVideo
com.android.cts.prov.ctsshim
com.google.android.ext.services
com.google.android.katniss
com.android.providers.telephony
com.android.dynsystem
com.android.providers.calendar
com.android.tv.settings
com.android.providers.media
com.google.android.onetimeinitializer
com.android.wallpapercropper
com.actions.hidaudio
com.softwinner.awlogsettings
com.android.documentsui
com.android.externalstorage
com.android.htmlviewer
com.ghisler.android.TotalCommander
com.android.companiondevicemanager
com.android.mms.service
com.android.providers.downloads
com.android.providers.tv
com.android.networkstack.inprocess
com.adups.fota
com.softwinner.dragonbox
com.google.android.configupdater
com.sv.tvcustomizer
com.android.providers.downloads.ui
com.android.vending
com.android.pacprocessor
com.android.simappdialog
com.android.modulemetadata
com.android.certinstaller
com.google.android.leanback.ime
com.google.android.landscape
android
com.android.camera2
com.liajt.otaapk
com.android.egg
com.android.mtp
com.android.nfc
com.android.nfx
com.android.backupconfirm
com.nst.iptvsmarterstvbox
com.android.provision
com.android.statementservice
com.android.hotspot2
com.swe.myapplication
com.www.productdeclare
com.android.settings.intelligence
com.ui.lb.tvui
com.android.providers.settings
com.android.sharedstoragebackup
com.android.printspooler
com.android.dreams.basic
com.android.webview
com.android.se
com.android.inputdevices
com.android.bips
com.google.android.tvrecommendations
com.google.android.leanbacklauncher.recommendations
com.android.musicfx
com.google.android.tvlauncher
com.example.playreadydemo
android.ext.shared
com.android.onetimeinitializer
com.android.server.telecom
com.android.keychain
com.android.chrome
com.android.printservice.recommendation
com.softwinner.settingsassist
com.android.gallery3d
com.google.android.gms
com.google.android.gsf
android.ext.services
com.google.android.partnersetup
com.android.dreams.web
com.android.localtransport
com.android.packageinstaller
org.xbmc.kodi
com.android.proxyhandler
com.netflix.mediaclient
com.android.inputmethod.latin
com.android.managedprovisioning
com.allwinnertech.gmsintegration
com.amazon.avod.thirdpartyclient
com.example.vlc
com.allwinnertech.packageoverride
com.ftest
com.google.android.leanbacklauncher
com.google.android.backuptransport
com.android.storagemanager
com.android.bookmarkprovider
com.android.settings
com.android.networkstack.permissionconfig
com.termux
com.android.cts.ctsshim
com.google.android.youtube.tv
com.android.vpndialogs
com.android.mgstv
com.android.music
com.android.phone
com.android.shell
com.android.wallpaperbackup
com.android.providers.blockednumber
com.android.providers.userdictionary
com.ionitech.airscreen
com.android.location.fused
com.android.deskclock
com.android.systemui
com.android.bluetoothmidiservice
com.softwinner.awmanager
com.android.permissioncontroller
com.wncc.xhsxremote
com.softwinner.miracastReceiver
com.android.traceur
com.android.bluetooth
com.android.providers.contacts
com.android.captiveportallogin
com.www.intallapp
com.softwinner.TvdFileManager
android.auto_generated_rro_vendor__</code></pre>
    <p>So, most of this looks pretty normal right? Run of the mill
      Android packages. But there were a few things which caught my
      attention, one of which being a nifty lil package named ‚Äò<a
        href="../../images/blog/tvspyware/PdOta.apk"><strong>com.liajt.otaapk</strong></a>‚Äô.
      ‚ÄúOwO what‚Äôs this?‚Äù you may ask. To that I say you need to touch some
      grass but also, it is a program for OTA updates for the TV box.
      Basically, it calls a server to check if there are any new updates,
      and if there are, it downloads and installs it. Cool. Let‚Äôs take a
      little peek shall we?</p>
    <p>So, I firstly pulled the APK via ADB from it‚Äôs location that was
      revealed by running:</p>
    <pre><code>adb shell pm path com.liajt.otaapk</code></pre>
    <p>Then I bust open my favorite tool for APK decompiling (<a href="https://github.com/skylot/jadx">JADX</a>) and got
      to work.</p>
    <p>My first task was to see exactly what calls this program was
      making to what server to check for the newest update. The easiest
      way to do this is just to search for text in the decompiled APK,
      enable searching of classes, methods, fields, codes, resources and
      comments. Then my fellow bitches, bros and enby hoes, that‚Äôs when I
      found it!</p>
    <p><img src="../../images/blog/tvspyware/jadx_https.png" alt="captionless image" /></p>
    <p>As we can see in the screenshot, it seems to reference a class
      named ‚ÄòMyService‚Äô, so I dug inside and oh my God is it big, so I‚Äôve
      decided to leave the decompiled source for the entire class <a
        href="../../images/blog/tvspyware/MyService.txt">here</a>, but let‚Äôs take a
      closer look.</p>
    <p>It‚Äôs messy Java that contains <strong>A LOT</strong> of
      obfuscated fixed strings and integers, but very gradually, we can
      start to piece some tidbits of information together.</p>
    <p><img src="../../images/blog/tvspyware/snippet.png" alt="captionless image" /> <img
        src="../../images/blog/tvspyware/snippet2.png" alt="captionless image" />
      <img src="../../images/blog/tvspyware/snippet3.png" alt="captionless image" />
    </p>
    <p>Woah, that sure looks sketchy‚Ä¶</p>
    <p>So, these are just 3 peculiar snippets of code from the <a
        href="../../images/blog/tvspyware/MyService.txt">MyService</a> class, and we
      can see something interesting happen in each of them. I‚Äôll start
      with describing what we get from these though, we now know at least
      1 of the C2‚Äôs that this box talks to (no doubt there are more). It‚Äôs
      hosted at the URL <a href="https://appstore.coob.top">appstore.coob.top</a> and there
      seem to be a fair few API endpoints that we can play with here, with
      all of them being at the <strong>/prod-api</strong> path. But
      firstly, let‚Äôs dissect these snippets one by one shall we?</p>
    <ol type="1">
      <li>
        <p>In the first snippet, we can see that it‚Äôs checking a string
          named ‚Äò<strong>m1780p</strong>‚Äô to see if it‚Äôs filled, if it isn‚Äôt,
          it then gets filled with [<a
            href="https://appstore.coob.top/prod-api](https://appstore.coob.top/prod-api)">https://appstore.coob.top/prod-api](https://appstore.coob.top/prod-api)</a>,
          but then replaces the <strong>/prod-api</strong> with
          <strong>/profile</strong>. Very odd, in the next variable
          (<strong>m2307d</strong>), we can see that it sends an internal log
          which says exactly: ‚Äò**checkDelApk: [<a
            href="https://appstore.coob.top/prod-api/system/api/listDelApp](https://appstore.coob.top/prod-api/system/api/listDelApp)**‚Äô">https://appstore.coob.top/prod-api/system/api/listDelApp](https://appstore.coob.top/prod-api/system/api/listDelApp)**‚Äô</a>,
          then it does something with the aforementioned URL as it mentions it
          again, and then a bunch of Java fuckery that I cannot
          decipher
        </p>
      </li>
      <li>
        <p>In the second snippet, we can see that there‚Äôs a catch for if
          the ‚ÄòonCreate‚Äô class throws a SecurityException. From there it will
          try to <strong>gather information on the devices manufacturer,
            device model, version and chip type via shell commands</strong>,
          then it logs those internally in a string which displays them all
          neatly. I‚Äôm not at all bothered by this, very common practice to
          check that the update file which you‚Äôre getting is actually
          compatible with your system. What I am bothered with though is
          beneath that, where it uses the a site called ‚Äò<a href="https://realip.cc">realip.cc</a>‚Äô (<strong>public IP
            revealer
            site</strong>) which then stores your IP in a string and sends it to
          the C2 later. This is extremely sketchy behavior and it is not at
          all normal with regular updating software.</p>
      </li>
    </ol>
    <p>Finally, the third snippet. As we can see, there is a variable
      named ‚Äò<strong>m2310h</strong>‚Äô and it logs a string internally that
      looks like: ‚Äò**updateDev: [<a
        href="https://appstore.coob.top/prod-api/system/api/updateDev](https://appstore.coob.top/prod-api/system/api/updateDev)**‚Äô">https://appstore.coob.top/prod-api/system/api/updateDev](https://appstore.coob.top/prod-api/system/api/updateDev)**‚Äô</a>,
      followed by some JSON derived from another variable named
      ‚Äò<strong>f4477m</strong>‚Äô???. Later on, it then sends that request
      to the C2. Ok, curious, now we need to figure out what
      ‚Äò<strong>f4477m</strong>‚Äô is so we can see what is being sent.
      Thankfully, that wasn‚Äôt too difficult. Usually, global variables are
      defined at the top of any piece of Java code (much like most other
      languages), and fortunately in this case it was no different. If we
      go to the top of the file we can see ‚Äò<strong>f4477m</strong>‚Äô
      mentioned as referencing another class named
      ‚Äò<strong>AsDevice</strong>‚Äô.</p>
    <p><img src="../../images/blog/tvspyware/asdevice.png" alt="captionless image" /></p>
    <p>Then I noticed in the sidebar that there was a subfolder named
      ‚Äò<a href="../../images/blog/tvspyware/bean.mp4">bean</a>‚Äô, and in this
      subfolder lied the ‚Äò<strong>AsDevice</strong>‚Äô class.</p>
    <p><img src="../../images/blog/tvspyware/asdevice_location.png" alt="captionless image" /></p>
    <p>Now, as for what‚Äôs inside the ‚Äò<strong>AsDevice</strong>‚Äô class,
      it basically just creates a bunch of new strings that look similar
      to this:</p>
    <pre><code>public String getAndroidVer() {
    return this.androidVer;
}</code></pre>
    <p>But don‚Äôt get me wrong, there are <em>many</em> of these. It
      gathers information on everything from Android version, chip type
      and status of the device, all the way to your <strong>EXACT FUCKING
        LATITUDE AND LONGITUDE!!!!!!!!!!!</strong></p>
    <p><img src="../../images/blog/tvspyware/asdevice_haha_more_like_assus.png" alt="captionless image" /></p>
    <p>Now, if you just search for the variables listed like
      ‚Äò<strong>getLongitude()</strong>‚Äô in the project, you can find other
      small snippets of code in the APK where it requires
      <strong>INTENSE</strong> GPS permissions without giving you (<em>the
        user</em>) any warning that this app is requesting these
      permissions. I won‚Äôt show screenshots of it here as it‚Äôs ultimately
      irrelevant, we can see clearly in ‚Äò<strong>AsDevice</strong>‚Äô that
      we know what it does.
    </p>
    <p>Regardless, if we go back to the third snippet, we can now
      finally start to put all the little pieces together that we‚Äôve
      learned thus far.</p>
    <p><img src="../../images/blog/tvspyware/conspiracy_board.png" alt="captionless image" /></p>
    <p>Ok, gather around everyone, team meeting, this is what we know so
      far. A variable in the ‚Äò<strong>MyService</strong>‚Äô class named
      ‚Äò<strong>m2310h</strong>‚Äô has some funky stuff going on. It sends a
      POST request to [<a
        href="https://appstore.coob.top/prod-api/system/api/updateDev](https://appstore.coob.top/prod-api/system/api/updateDev)">https://appstore.coob.top/prod-api/system/api/updateDev](https://appstore.coob.top/prod-api/system/api/updateDev)</a>
      with some data that it converts into JSON included. We can see that
      this JSON is gathered from a link which points it to a separate
      class named ‚Äò<strong>AsDevice</strong>‚Äô, if we look at the
      ‚Äò<strong>AsDevice</strong>‚Äô class, we can see that it gathers a
      bunch of system specs and <strong>your literal fucking
        address</strong>, then sends it to the ‚Äò<strong>updateDev</strong>‚Äô
      endpoint mentioned above by following what I just explained in
      reverse.</p>
    <p><em>deep breath</em>, hooooooooooooly shit.</p>
    <p>So why not simulate that ourselves? I tried making a POST request
      with curl using the exact same data (the results of
      ‚Äò<strong>f4477m</strong>‚Äô converted into JSON) but I filled the
      designated fields with random data, it looked like this:</p>
    <p><img src="../../images/blog/tvspyware/post_attempt.png" alt="captionless image" /></p>
    <p>And the response I got:</p>
    <p><img src="../../images/blog/tvspyware/post_response.png" alt="captionless image" /></p>
    <p>Yep, accidental SQLi -_-. Absolute cinema, but on the bright
      side, this does give us some information about what type of API this
      is running, if we look at the filename that it‚Äôs calling, we can see
      a curious string in it called ‚Äò<strong>ruoyi-admin.jar</strong>‚Äô,
      this can be further confirmed if we go to the <a
        href="https://appstore.coob.top/prod-api/"><strong>/prod-api</strong></a>
      path of the C2, we can see this curious lil message.</p>
    <p><img src="../../images/blog/tvspyware/ruoyi.png" alt="captionless image" /></p>
    <p>Now, I don‚Äôt speak Chinese, so I chucked it into Google Translate
      and this is what it gave me:</p>
    <blockquote>
      <p>Welcome to the RuoYi backend management framework, current
        version: v3.9.0, please access it through the front-end address.</p>
    </blockquote>
    <p>Hmm, upon further research, <a href="https://github.com/yangzongzhuan/RuoYi-Vue3">RuoYi</a> is an
      incredibly popular Chinese-made open source framework that leverages
      Spring Boot and Vue for building APIs in quite a simple manner. I
      spent a few days manually scouring the source code of this
      (<em>big</em>) repo looking for any way to gain access to the main
      dashboard, including looking for SQLi avenues but sadly, everything
      is quite well sanitized. I even tried using tools like <a
        href="https://github.com/sqlmapproject/sqlmap">sqlmap</a> and <a
        href="https://github.com/r0oth3x49/ghauri">Ghauri</a> on the
      ‚Äò<strong>/updateDev</strong>‚Äô endpoint I discussed earlier, but
      sadly to no avail (mainly due to the fact that the site uses a
      CloudFlare WAF)</p>
    <p>So in conclusion for this segment, <a
        href="https://noyb.eu/en/tiktok-aliexpress-shein-co-surrender-europeans-data-authoritarian-china">I
        shouldn‚Äôt have to explain why Chinese manufacturers getting the
        location of where you jerk it at night is a bad thing</a>. But the
      TL;DR is ‚Äòdata collection‚Äô. Let‚Äôs take this APK as an example, based
      on the information that gets sent to the C2, they can then use this
      data to track your watching habits (via further telemetry), send
      this to a more centralized server in the PRC which aggregates
      telemetry and marketing data from <strong>ALL</strong> the available
      sources and feeds you more ads from that.</p>
    <p>For example, let‚Äôs say you really enjoyed Stranger Things and
      watched it via the Netflix app on the Q10 box, telemetry about what
      you watched as well as your live location then gets sent to a data
      center in China. You also have a smartphone with TikTok installed
      which you browse frequently, now, the aforementioned data center
      will look at the location it gets from TikTok (on your phone), and
      the location of where you watched Stranger Things (the Q10 box),
      plus maybe you‚Äôve searched for Stranger Things on TikTok. Using a
      mixture of AI and unimaginably precise algorithms, it will make a
      decision of ‚Äòthis is the same person‚Äô and will start sending you ads
      on TikTok for Stranger Things merch from sites like AliExpress and
      Temu. This system is designed to work against you for the
      advancement of a world where privacy is a thing of the past.</p>
    <p>Anyways, let‚Äôs move away from the OTA update program for now and
      talk about what I originally bought this box for, to remove malware.
      If we take a look at the <a href="#packages">packages I detected on
        the box earlier</a>, we can definetly see quite a fair few files
      that we need to dig through and remove. Fortunately, this wasn‚Äôt an
      issue for me as I had quite a clever idea for this. I assumed that a
      lot of these packages were analyzed in the past via <a href="https://www.virustotal.com/gui/">VirusTotal</a>, so
      if I could
      find a way to search them up on there, see which ones had a high
      malware score, then I‚Äôd know which ones I‚Äôd need to remove.</p>
    <p>One issue with that though, I‚Äôd surely get rate-limited by
      VirusTotal if I tried to upload all of them at once, and I wasn‚Äôt
      prepared to pay <a href="https://www.reddit.com/r/cybersecurity/comments/10ph5jm/comment/j7cmo8d/"><strong>$25k
          USD</strong></a> for enterprise access. So I came up with a bit of
      an ingenius idea. I wrote a simple Python script which pulled all
      the APK files to my PC via adb, then SHA256 hashed them and printed
      the hashes next to the package name. Awesome. After doing this I got
      a long list of SHA256 hashes that I manually plugged into VirusTotal
      one-by-one. After my analysis, I came to a pretty clear
      conclusion.</p>
    <ul>
      <li><strong>‚Äòcom.softwinner.*‚Äô</strong> are Allwinner utilities that
        were known to contact a myriad of Chinese IPs</li>
      <li><strong>‚Äôcom.liajt.otaapk‚Äô</strong> is the OTA update program
        which I discussed in length earlier</li>
      <li><strong>‚Äôcom.sv.tvcustomizer‚Äô</strong> also contacted a lot of
        Chinese IPs</li>
      <li><a
          href="https://www.first.org/resources/papers/valencia2017/dzerins-janis_slides.pdf"><strong>‚Äôcom.adups.fota‚Äô</strong></a>
        is a notorious update utility known for collecting vast amounts of
        telemetry and sending it to China. Sadly this isn‚Äôt a Q10 specific
        issue as I‚Äôve dealt with this package on numerous devices in the
        past, still not something I want on my system though.</li>
      <li><strong>‚Äòcom‚Äã.www‚Äã.intallapp‚Äô</strong> is the secondary app for
        Adups Fota (mentioned above)</li>
      <li><strong>‚Äòcom.ftest‚Äô</strong> is also another suspricious package
        which sends telemetry to China</li>
      <li><strong>‚Äôcom‚Äã.www‚Äã.productdeclare‚Äô</strong> is also another dodgy
        package too which also sends telemetry</li>
      <li><strong>‚Äôcom.ui.lb.tvui‚Äô</strong> is a built-in program used to
        list and launch the SoftWinner utilities, done under the name
        ‚ÄòAppList‚Äô</li>
    </ul>
    <p>These were the packages that raised the most suspicion for me as
      they all had fairly high ratings on VirusTotal. So I just
      uninstalled them each one-by-one with the command:</p>
    <pre><code>adb shell pm uninstall --user 0 $package_name_here</code></pre>
    <p>Now, this command sadly has a bit of a downside. Do you notice
      that ‚Äò‚Äîuser 0‚Äô flag in the middle? That basically tells it to
      uninstall the program from my user, however it doesn‚Äôt remove the
      program systemwide as these programs were installed with root. So
      while this doesn‚Äôt delete the packages entirely, it does render them
      basically useless.</p>
    <p>So after that, I rebooted my Q10 box to make sure that everything
      was alright and voila, it was about as stock as I could get it. I
      just manually uninstalled all the IPTV applications (as I wasn‚Äôt
      going to use those), sideloaded the APKs for <a
        href="https://play.google.com/store/apps/details?id=org.jellyfin.androidtv&amp;hl=en_NZ">Jellyfin</a>,
      <a href="https://play.google.com/store/apps/details?id=app.symfonik.music.player&amp;hl=en_NZ">Symfonium</a>,
      <a href="https://play.google.com/store/apps/details?id=com.google.android.youtube.tv&amp;hl=en_NZ">YouTube</a>,
      <a href="https://play.google.com/store/apps/details?id=nz.co.tvnz.ondemand.phone.android&amp;hl=en_NZ">TVNZ+</a>
      and boom. Total FOSS win!
    </p>
    <p>I‚Äôm now able to play any 1080p video with any type of codec, as
      well as stream my 200gb music library, binge some of my favorite
      YouTubers or watch some local Kiwi TV, all without the fear of
      Chinese spying!</p>
    <p><img src="../../images/blog/tvspyware/home.jpg" alt="captionless image" /> <img
        src="../../images/blog/tvspyware/jellyfin.jpg" alt="captionless image" />
      <img src="../../images/blog/tvspyware/symfonium.jpg" alt="captionless image" /> <img
        src="../../images/blog/tvspyware/youtube.jpg" alt="captionless image" />
      <img src="../../images/blog/tvspyware/tvnz.jpg" alt="captionless image" />
    </p>
    <p>I have to say, what an awesome little project this was! But it is
      definetly far from over. I‚Äôm co-operating with some amazing folks on
      the <a href="https://xdaforums.com/">XDA forums</a> to try and see
      if we can get a dump of the firmware for this (somehow), modify it
      and root it so we can fully remove these spyware packages. Best case
      scenario, I can even release my own firmware image for a completely
      stock experience with this box!</p>
    <p>But that will be a part 2 for another day haha. Regardless, thank
      you all so much for reading this article, please share it to friends
      or family who may be interested and as always, have a great day
      :3</p>

    <div class="buttons" id="buttons">
      <img src="../../images/buttons/transbian.png" />
      <img src="../../images/buttons/acab.gif" />
      <img src="../../images/buttons/therian.png" />
      <img src="../../images/buttons/twopaws.png" />
      <img src="../../images/buttons/soulseek.gif" />
    </div>
    <script>
      const footnotes = document.querySelector('.footnotes');
      const callout = document.getElementById('buttons');
      if (footnotes && callout) footnotes.before(callout);
    </script>
  </article>
</body>

</html>